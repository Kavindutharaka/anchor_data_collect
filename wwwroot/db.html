
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="keywords" content="Prasanthahv " />
    <meta name="description" content="Prasanthahv, phv " />

    <title>TB - Records</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="app.css" />
    <link rel="stylesheet" href="sup/animate.css" />

    <script type="text/javascript" src="sup/angular.min.js"></script>
    <script type="text/javascript" src="db.js?t=260985004"></script>
</head>
<body ng-app="PHVApp" ng-cloak ng-controller="HomeCtrl">

    <div class="container" style="max-width:960px;margin-top:10px;">

        <!-- Logo Header -->
        <div class="logo-header">
            <img src="logo/fonterra-masterbrand-logo.png" alt="Fonterra" style="cursor:default;" />
        </div>

        <div class="page-header">
            <h1>Shop Visit Records</h1>
        </div>

        <!-- Image View Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">{{pn}}</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" style="text-align:center;">
                        <img ng-src="{{img_url}}" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary btn-block" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============ FILTERS ============ -->
        <div class="date-filter">
            <div class="date-filter-title">Filter Records</div>
            <div class="date-filter-row">
                <div class="date-filter-field">
                    <label>From</label>
                    <input type="date" ng-model="filter_from" />
                </div>
                <div class="date-filter-field">
                    <label>To</label>
                    <input type="date" ng-model="filter_to" />
                </div>
                <div class="date-filter-field" style="min-width:130px;">
                    <label>Root Code</label>
                    <select ng-model="filter_code" style="width:100%;background:var(--bg-input);color:var(--text-primary);border:1px solid var(--border);border-radius:6px;padding:8px 10px;font-size:14px;outline:none;appearance:none;-webkit-appearance:none;box-sizing:border-box;">
                        <option value="">All Codes</option>
                        <option ng-repeat="c in savedCodes" value="{{c}}">{{c}}</option>
                    </select>
                </div>
                <div class="date-filter-btns">
                    <button type="button" class="btn-filter" ng-click="filterRecords()">Filter</button>
                    <button type="button" class="btn-filter-clear" ng-click="clearFilter()">All</button>
                </div>
            </div>
        </div>

        <!-- ============ DESKTOP TABLE VIEW ============ -->
        <table class="table desktop-table">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Code</th>
                    <th scope="col">Shop Info</th>
                    <th scope="col">Map</th>
                    <th scope="col">Board</th>
                    <th scope="col">Rack Before</th>
                    <th scope="col">Rack After</th>
                    <th scope="col">Signature</th>
                    <th scope="col">Selfie</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="ee in reg_lst">
                    <th scope="row" style="color:var(--accent);">
                        {{$index + 1}}
                    </th>
                    <td>
                        <span style="font-weight:700;font-size:12px;background:var(--bg-label);color:var(--text-label);padding:3px 8px;border-radius:12px;white-space:nowrap;">{{ee.root_code}}</span>
                    </td>
                    <td>
                        <div style="font-weight:700;color:var(--text-primary);">{{ee.shop_name}}</div>
                        <div style="color:var(--text-secondary);">{{ee.owner_contact}}</div>
                        <div style="color:var(--text-secondary);">{{ee.shop_address}}</div>
                        <div style="color:var(--accent);font-size:12px;">{{ee.created_dt | date :'yy/MM/dd HH:mm'}}</div>
                    </td>
                    <td><a href="https://www.google.com/maps/search/?api=1&query={{ee.lat}},{{ee.lng}}" target="_blank" style="color:var(--accent);">OPEN</a></td>
                    <td><button type="button" class="btn btn-sm" style="background:var(--accent-green);color:#fff;" ng-click="pic_view(ee, ee.board_img)" data-toggle="modal" data-target="#exampleModal">View</button></td>
                    <td><button type="button" class="btn btn-sm" style="background:var(--accent-green);color:#fff;" ng-click="pic_view(ee, ee.rack_before_img)" data-toggle="modal" data-target="#exampleModal">View</button></td>
                    <td><button type="button" class="btn btn-sm" style="background:var(--accent-green);color:#fff;" ng-click="pic_view(ee, ee.rack_after_img)" data-toggle="modal" data-target="#exampleModal">View</button></td>
                    <td><button type="button" class="btn btn-sm" style="background:var(--accent-green);color:#fff;" ng-click="pic_view(ee, ee.signature_img)" data-toggle="modal" data-target="#exampleModal">View</button></td>
                    <td><button type="button" class="btn btn-sm" style="background:var(--accent);color:#fff;" ng-click="pic_view(ee, ee.selfie_img)" data-toggle="modal" data-target="#exampleModal">View</button></td>
                </tr>
            </tbody>
        </table>

        <!-- ============ MOBILE CARD VIEW ============ -->
        <div class="mobile-cards" style="display:none;">
            <div class="shop-card" ng-repeat="ee in reg_lst">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:4px;">
                    <div class="shop-card-num">#{{$index + 1}}</div>
                    <span style="font-size:11px;font-weight:700;background:var(--bg-label);color:var(--text-label);padding:2px 10px;border-radius:12px;">{{ee.root_code}}</span>
                </div>
                <div class="shop-card-title">{{ee.shop_name}}</div>
                <div class="shop-card-sub">{{ee.owner_contact}}</div>
                <div class="shop-card-sub">{{ee.shop_address}}</div>
                <div class="shop-card-sub" style="color:var(--accent);margin-top:4px;">{{ee.created_dt | date :'yy/MM/dd HH:mm'}}</div>
                <div class="shop-card-btns">
                    <a class="btn-card btn-card-outline" href="https://www.google.com/maps/search/?api=1&query={{ee.lat}},{{ee.lng}}" target="_blank">Map</a>
                    <button type="button" class="btn-card btn-card-green" ng-click="pic_view(ee, ee.board_img)" data-toggle="modal" data-target="#exampleModal">Board</button>
                    <button type="button" class="btn-card btn-card-green" ng-click="pic_view(ee, ee.rack_before_img)" data-toggle="modal" data-target="#exampleModal">Before</button>
                    <button type="button" class="btn-card btn-card-green" ng-click="pic_view(ee, ee.rack_after_img)" data-toggle="modal" data-target="#exampleModal">After</button>
                    <button type="button" class="btn-card btn-card-green" ng-click="pic_view(ee, ee.signature_img)" data-toggle="modal" data-target="#exampleModal">Sign</button>
                    <button type="button" class="btn-card btn-card-blue" ng-click="pic_view(ee, ee.selfie_img)" data-toggle="modal" data-target="#exampleModal">Selfie</button>
                </div>
            </div>
        </div>

    </div>

</body>
</html>
